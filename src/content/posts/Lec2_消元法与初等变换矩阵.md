---
title: Lec2_消元法与初等变换矩阵
published: 2024-08-29
description: ''
image: ''
tags: [Linear Algebra]
category: 'Math'
draft: false 
lang: ''
---

#  Part 1 消元法与初等变换

&emsp;&emsp;求解线性方程组时，很多同学会最先想到消元法。这是最自然、我们最熟悉的方法。大部分计算机程序在求解时也使用消元法。

&emsp;&emsp;比如对线性方程组：
$$
\begin{cases}
x&+~~2y&+~~z=2····①\\
3x&+~~8y&+~~z=12····②\\
&~~~~~4y&+~~z=2····③
\end{cases}
$$
&emsp;&emsp;进行消元时，第一步常是先通过①、②直接的计算来处理掉$x$，也就是将①式乘3得到$3x+6y+3z=6$，再用②减去该式得到$2y-2z=6$。
$$
\begin{cases}
x&+~~2y&+~~z=2····①\\
&~~~~~2y&-~2z=6····②\\
&~~~~~4y&+~~z=2····③
\end{cases}
$$
&emsp;&emsp;对应到系数矩阵中，也就是第二行减去第一行的三倍。
$$
\begin{bmatrix}
1&2&1\\
3&8&1\\
0&4&1
\end{bmatrix}\\
\xrightarrow{{R_{2}-3R_{1}}}\\
\begin{bmatrix}
1&2&1\\
0&2&-2\\
0&4&1
\end{bmatrix}\\
\xrightarrow{{R_{3}-2R_{2}}}\\
\begin{bmatrix}
1&2&1\\
0&2&-2\\
0&0&5
\end{bmatrix}\\
$$
&emsp;&emsp;这个过程中，我们实际上选择了第一行$x$的系数作为主元，逐行将其它未被选作主元行中$x$的系数调整为0，从而实现对其余方程组的降元。因此，主元一定不能为零。我们不断地选取主元，当方程组降低至一元一次时，可以得到一个未知数的值，这里是得到了$z$的值。再进行回代，就得到了方程组的完整解。

&emsp;&emsp;如果消元法可以成功，我们就成功得到了一个“上三角矩阵”。如果我们对系数进行调整，将整行系数乘以某个非零常数来把对角线上的数全变为一，还可以得到更美观的单位上三角矩阵。
$$
\begin{bmatrix}
1&2&1\\
0&2&-2\\
0&0&5
\end{bmatrix}\\
\xrightarrow{{R_{2}×\frac{1}{2},R_{3}×\frac{1}{5}}}\\
\begin{bmatrix}
1&2&1\\
0&1&-1\\
0&0&1
\end{bmatrix}\\
$$
&emsp;&emsp;在消元过程中用到的操作（将第$i$ 行/列 加上第$j$ 行/列 的$k$倍、将某行（列）乘以一个非零常数），以及交换任意两行（列）称为矩阵的初等变换。

&emsp;&emsp;有同学可能会疑惑，方程组右侧的常数向量呢？实际上，常数向量完全可以放在矩阵中一起计算，这样带有常数向量的矩阵称为“增广矩阵”。不过，在上一节中我们已经谈过，方程组是否存在唯一解完全取决于系数矩阵。对系数矩阵进行消元操作可以判断解的存在性。如matlab等软件也先对系数矩阵进行消元，并将过程中初等变换的操作序列记录下来，确定有唯一解后再对右侧向量进行交换。
$$
\begin{bmatrix}
1&2&1&2\\
3&8&1&12\\
0&4&1&2
\end{bmatrix}\\
\xrightarrow{{R_{2}-3R_{1}}}\\
\begin{bmatrix}
1&2&1&2\\
0&2&-2&6\\
0&4&1&2
\end{bmatrix}\\
\xrightarrow{{R_{3}-2R_{2}}}\\
\begin{bmatrix}
1&2&1&2\\
0&2&-2&6\\
0&0&5&-10
\end{bmatrix}\\\xrightarrow{{R_{2}×\frac{1}{2},R_{3}×\frac{1}{5}}}\\
\begin{bmatrix}
1&2&1&2\\
0&1&-1&3\\
0&0&1&-2
\end{bmatrix}\\
$$
&emsp;&emsp;只要消元法成功就能得到方程组的解。那么，什么时候消元会失败呢？

&emsp;&emsp;从消元法的过程中我们可以看出，只要能寻找到n个主元，就一定能成功。主元不存在的情况又有哪些呢？最容易想到的是系数矩阵中存在一行全部为零时。除此之外，当矩阵中任意两行成比例时，也会在消元过程中出现全为零的一行。关于它的证明，我们可以先使用某行乘以任意常数的初等变换来将需证明的情况统一为两行完全相同。在这两行中的任意一行被选作主元前，其它行作为主元时对它们两行进行消元时减去的值一定是相同的，从而使得这两行始终保持相同，直到其中一行被选择为主元。此时，由一行来对另一行进行消元时会发生两行相减，从而出现全零行。
$$
欲证明:当任意两行成比例时,消元法过程中会出现一行全为零的情况\\
不妨使用初等行变换中的对一行乘以常数来将情况统一为存在两行相等\\
在这两行的任意一行被选为主元前:\\
容易知道主元对这两行进行消元时,所用的系数是相同的,即这两行各元素的变化完全相同\\
也就是:直到这两行其中任意一行被选为主元,两行都将保持相同\\
而其中某行被选为主元时,容易知道:主元该行对另一行进行消元时,就会出现两完全相等行相减的情况\\
也就是将出现全为0的行,\square
$$

# Part 2 初等变换矩阵

&emsp;&emsp;我们先聊聊对于矩阵乘法的理解。其定义我们不再介绍，但对其的直观理解可以有很多方式。上一节中，我们提到了列图像。用列图像的想法来看，矩阵乘法中的后一个矩阵实际上指定了前一个矩阵列向量进行线性组合时的系数。比如我们本例中的方程组：
$$
\begin{cases}
x&+~~2y&+~~z=2····①\\
3x&+~~8y&+~~z=12····②\\
&~~~~~4y&+~~z=2····③
\end{cases}
$$
&emsp;&emsp;其左侧实际上可以记录为系数矩阵$A=\begin{bmatrix}
1&2&1\\
3&8&1\\
0&4&1
\end{bmatrix}$与矩阵$\begin{bmatrix}
x\\y\\z\end{bmatrix}$的乘积。矩阵$A$的列向量以系数$x、y、z$进行线性组合后即得到了方程组左侧。x为第一个列向量的系数，y、z分别为第二、三个列向量的系数。即：
$$
\begin{bmatrix}
1&2&1\\
3&8&1\\
0&4&1
\end{bmatrix}\begin{bmatrix}
x\\y\\z\end{bmatrix}=x\begin{bmatrix}
1\\3\\0\end{bmatrix}+y\begin{bmatrix}
2\\8\\4\end{bmatrix}+z\begin{bmatrix}
1\\1\\1\end{bmatrix}=\begin{bmatrix}
x+2y+z\\3x+8y+z\\4y+z\end{bmatrix}
$$
&emsp;&emsp;对于右侧矩阵列数大于1的情况，只需要看作左侧矩阵与多个一维列向量相乘，并按照右侧列向量在原来矩阵中的位置排列即可。
$$
\begin{bmatrix}1&2&1\\3&8&1\\0&4&1\end{bmatrix}\begin{bmatrix}x&m\\y&n\\z&q\end{bmatrix}=\begin{bmatrix}x\begin{bmatrix}1\\3\\0\end{bmatrix}+y\begin{bmatrix}2\\8\\4\end{bmatrix}+z\begin{bmatrix}1\\1\\1\end{bmatrix}~~~~~m\begin{bmatrix}1\\3\\0\end{bmatrix}+n\begin{bmatrix}2\\8\\4\end{bmatrix}+q\begin{bmatrix}1\\1\\1\end{bmatrix}\end{bmatrix}=\begin{bmatrix}x+2y+z&m+2n+q\\3x+8y+z&3m+8n+q\\4y+z&4n+q\end{bmatrix}
$$
&emsp;&emsp;有了这个解释，我们就可以想到列初等变换矩阵的形态。既然每个列向量都给出了系数，我们只需要按照列变换的操作对矩阵进行相应的填充即可。举个例子来说，我们先有一个3x3的单位矩阵：
$$
\begin{bmatrix}
1&0&0\\
0&1&0\\
0&0&1
\end{bmatrix}
$$
&emsp;&emsp;右乘它，结果仍为原矩阵。如果我们想将第1列加上第3列的2倍，也就是第一列变为了原第一列的1倍和第三列的2倍的线性组合。对应地，矩阵就应该变为：
$$
\begin{bmatrix}
1&0&0\\
0&1&0\\
2&0&1
\end{bmatrix}\\
$$
&emsp;&emsp;类似的思路下我们就可以给出所有的列初等变换矩阵。它正好是对单位矩阵执行同样列变换后得到的矩阵。换句话说，我们可以通过对单位矩阵E进行列变换，然后将其右乘到矩阵A上，来实现对矩阵A的相同列变换。

&emsp;&emsp;而行变换初等矩阵的形态也是类似的，只需要对单位矩阵E进行行变换，然后将其左乘到矩阵A上，即可实现对矩阵A相同的行变换。我们仍旧用上面这个简单的例子来理解一下：
$$
\begin{bmatrix}
1&0&0\\
0&1&0\\
3&0&1
\end{bmatrix}
$$
&emsp;&emsp;当我们将第一列第三行设为3时，列向量变为$\begin{bmatrix}
1\\0\\3\end{bmatrix}$时，后方矩阵第一行的每个系数$x$都会使得对应列结果的第三行增加$3x$，起到了将第三行加上第一行的三倍的效果。我们最后使用消元法时的例子来验证一下。

&emsp;&emsp;初始系数矩阵为：
$$
\begin{bmatrix}
1&2&1\\
3&8&1\\
0&4&1
\end{bmatrix}
$$
&emsp;&emsp;不考虑最后调整第一个系数为1的操作，消元过程为：${R_{2}-3R_{1}}，{R_{3}-2R_{2}}$。
$$
\begin{bmatrix}
1&2&1\\
3&8&1\\
0&4&1
\end{bmatrix}\rightarrow\begin{bmatrix}
1&2&1\\
0&2&-2\\
0&4&1
\end{bmatrix}\rightarrow\begin{bmatrix}
1&2&1\\
0&2&-2\\
0&0&5
\end{bmatrix}
$$
&emsp;&emsp;我们对单位矩阵进行同样的操作，得到：
$$
\begin{bmatrix}
1&0&0\\
-3&1&0\\
6&-2&1
\end{bmatrix}
$$
&emsp;&emsp;验算一下：
$$
\begin{bmatrix}
1&0&0\\
-3&1&0\\
6&-2&1
\end{bmatrix}\begin{bmatrix}
1&2&1\\
3&8&1\\
0&4&1
\end{bmatrix}=\begin{bmatrix}
1&2&1\\
0&2&-2\\
0&0&5
\end{bmatrix}
$$
